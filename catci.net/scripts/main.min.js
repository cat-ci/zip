document.addEventListener("DOMContentLoaded",function(){let t=document.querySelectorAll(".cables img"),e=document.getElementById("video"),n=document.querySelector(".static");n&&n.classList.remove("static-on"),t.forEach(t=>{t.addEventListener("click",function(){this.classList.toggle("cable-up"),e.classList.contains("cable-up")?n&&n.classList.add("static-on"):n&&n.classList.remove("static-on")})})});const powerCheckbox=document.getElementById("power"),switchCheckbox=document.getElementById("switch");powerCheckbox.addEventListener("change",function(){switchCheckbox.checked=powerCheckbox.checked}),document.addEventListener("DOMContentLoaded",()=>{let t=[document.querySelectorAll("h1.crt-text span"),document.querySelectorAll("div[cx*='ts:8px'] span"),document.querySelectorAll("div[cx*='ts: 16px'] span"),],e=[.7,.2,.25,.5,.1,.6,.5,.5,.5],n=[900,1400,1200,1e3,1500,900,800,800,800],i=Array(t[0].length).fill(0);function o(e){function n(n=0){setTimeout(()=>{t.forEach(t=>{let n=t[e];n&&n.classList.add("flicker")}),setTimeout(()=>{t.forEach(t=>{let n=t[e];n&&n.classList.remove("flicker")})},20+20*Math.random())},n)}n(),.15>Math.random()&&n(60+40*Math.random()),i[e]=Date.now()}function s(){let e=t[0].length-4;t.forEach(n=>{for(let i=e;i<t[0].length;i++)n[i].classList.add("off")}),setTimeout(()=>{t.forEach(n=>{for(let i=e;i<t[0].length;i++)n[i].classList.remove("off")})},80+40*Math.random())}setInterval(()=>{let t=Date.now();e.forEach((e,s)=>{t-i[s]>n[s]&&Math.random()<.08*e&&o(s)}),.003>Math.random()&&s()},120)});const postItNote=document.getElementById("postItNote");let postItClickCount=0;function parseCloneAttr(t){let[e,n]=t.split(",").map(t=>t.trim());return{selector:e,mode:(n||"all").toLowerCase()}}function applyClone(t,e,n){if("all"===n){t.innerHTML="";let i=e.cloneNode(!0);i.removeAttribute("id"),i.removeAttribute("clone"),copyComputedStyle(i,e),t.appendChild(i)}else"content"===n?t.innerHTML=e.innerHTML:"style"===n&&copyComputedStyle(t,e)}function copyComputedStyle(t,e){let n=getComputedStyle(e);for(let i of n)t.style[i]=n.getPropertyValue(i)}function observeAndClone(t,e,n){applyClone(t,e,n);new MutationObserver(()=>{applyClone(t,e,n)}).observe(e,{attributes:!0,childList:!0,subtree:!0,characterData:!0}),("style"===n||"all"===n)&&new MutationObserver(()=>{applyClone(t,e,n)}).observe(e,{attributes:!0,attributeFilter:["style","class"]})}function setupClones(){document.querySelectorAll("[clone]").forEach(t=>{let{selector:e,mode:n}=parseCloneAttr(t.getAttribute("clone")),i=document.querySelector(e);i&&observeAndClone(t,i,n)})}function updateCounters(){let t={visits:document.querySelector(".counters li.visits span:last-child"),uniqueVisits:document.querySelector(".counters li.uniq-visits span:last-child"),onSite:document.querySelector(".counters li.on-site span:last-child")},e={visits:document.querySelectorAll(".real-counters li.all-visits img"),uniqueVisits:document.querySelectorAll(".real-counters li.visits img"),onSite:document.querySelectorAll(".real-counters li.viewers img")};function n(t){let e=[];return t.forEach(t=>{let n=t.getAttribute("src");if(!n.includes("l.gif")&&!n.includes("r.gif")){let i=n.match(/\/([0-9])\.gif$/);i&&i[1]&&e.push(i[1])}}),e.length>0?e.join("").padStart(8,"0"):"00000000"}t.visits&&(t.visits.textContent=n(e.visits)),t.uniqueVisits&&(t.uniqueVisits.textContent=n(e.uniqueVisits)),t.onSite&&(t.onSite.textContent=n(e.onSite))}function animateWires(){let t=document.querySelectorAll('svg[role="wire"]'),e=performance.now()/1e3;t.forEach(t=>{let n=t.clientWidth,i=parseFloat(t.dataset.basesag)||30,o=parseFloat(t.dataset.amplitude)||20,s=t.querySelector("path");s||(s=document.createElementNS("http://www.w3.org/2000/svg","path"),t.appendChild(s));let l=`M0,0 C ${n/3},${i+o*Math.sin(e)} ${2*n/3},${i+o*Math.cos(e)} ${n},0`;s.setAttribute("d",l)}),requestAnimationFrame(animateWires)}postItNote.addEventListener("click",function(t){if(2==++postItClickCount&&(postItNote.classList.add("gentle-swivel"),postItNote.addEventListener("animationend",function t(){postItNote.classList.remove("gentle-swivel"),postItNote.removeEventListener("animationend",t)})),3===postItClickCount){postItNote.style.pointerEvents="none";let e=t.clientX,n=window.innerWidth/2,i=(e-n)/n*45,o=postItNote.getBoundingClientRect(),s=o.top,l=window.innerHeight-s+200,r=null;function a(t){r||(r=t);let e=t-r,n=Math.min(e/1e3,1),o=n*n;postItNote.style.transform=`translateY(${o*l}px) rotate(${o*i}deg)`,postItNote.style.opacity=1-n,n<1?requestAnimationFrame(a):postItNote.remove()}postItNote.style.transformOrigin="50% 0%",requestAnimationFrame(a)}}),document.addEventListener("DOMContentLoaded",setupClones),setInterval(updateCounters,500),animateWires();const GRAVITY=.5,DECAY_BASE=.03,DECAY_RANDOM=.03,VELOCITY_X=15,VELOCITY_Y=10;class Spark{constructor(t,e){this.element=document.createElement("div"),this.element.className="spark",this.x=t,this.y=e,this.velocityX=(Math.random()-.5)*15,this.velocityY=(Math.random()-1)*10,this.gravity=.5,this.life=1,this.decay=.03*Math.random()+.03,document.body.appendChild(this.element),this.element.style.left=this.x+"px",this.element.style.top=this.y+"px",this.update()}updateRotation(){let t=Math.atan2(this.velocityY,this.velocityX);this.element.style.transform=`rotate(${180*t/Math.PI}deg)`}update(){this.life>0?(this.velocityY+=this.gravity,this.x+=this.velocityX,this.y+=this.velocityY,this.life-=this.decay,(this.x<-100||this.x>window.innerWidth+100||this.y<-100||this.y>window.innerHeight+100)&&(this.life=0),this.element.style.left=this.x+"px",this.element.style.top=this.y+"px",this.element.style.opacity=this.life,this.updateRotation(),requestAnimationFrame(()=>this.update())):this.element.remove()}}class SparkEmitter{constructor(t){this.element=t,this.spawnRate=parseInt(t.dataset.spawn)||30,this.x=0,this.y=0,this.updatePosition(),this.start()}updatePosition(){let t=this.element.getBoundingClientRect();this.x=t.left+t.width/2,this.y=t.top+t.height/2}start(){let t=()=>{100*Math.random()<this.spawnRate&&new Spark(this.x,this.y),requestAnimationFrame(t)};t()}}document.querySelectorAll(".emitter").forEach(t=>{let e=new SparkEmitter(t);window.addEventListener("resize",()=>e.updatePosition())});const warningElement=document.querySelector(".warning");function getRandomOpacity(){return .8*Math.random()+.2}function getRandomDuration(){return 140*Math.random()+20}function applyBrokenFlicker(){let t=Math.floor(5*Math.random())+3,e=0;!function n(){if(e<t){let i=getRandomOpacity(),o=getRandomDuration();warningElement.style.opacity=i,setTimeout(()=>{warningElement.style.opacity=1,e++,n()},o)}else warningElement.style.opacity=1,setTimeout(applyBrokenFlicker,1e4*Math.random()+5e3)}()}function getRandomInterval(t,e){return Math.random()*(e-t)+t}function blinkLED(t,e,n){!function i(){t.classList.toggle("off");let o=getRandomInterval(e,n);setTimeout(i,o)}()}applyBrokenFlicker();const redLED=document.querySelector(".led.active"),greenLED=document.querySelector(".led.green");blinkLED(redLED,50,1500),blinkLED(greenLED,50,1500),document.addEventListener("DOMContentLoaded",()=>{let t=document.querySelectorAll("[data-sound][data-maxvol][data-maxdist]"),e=new Map;function n(t,e,n){let i=n.getBoundingClientRect(),o=i.left+i.width/2,s=i.top+i.height/2;return Math.sqrt(Math.pow(t-o,2)+Math.pow(e-s,2))}function i(i,o){t.forEach(t=>{let s=parseFloat(t.getAttribute("data-maxvol"))||1,l=parseFloat(t.getAttribute("data-maxdist"))||100,r=n(i,o,t),a=e.get(t);r<=l?a.volume=Math.max(0,Math.min(s*(1-r/l),s)):a.volume=0})}t.forEach(t=>{let n=t.getAttribute("data-sound"),i=new Audio(n);i.loop=!0,i.volume=0,i.play(),e.set(t,i)}),document.addEventListener("mousemove",t=>{i(t.clientX,t.clientY)}),document.addEventListener("visibilitychange",()=>{document.hidden&&e.forEach(t=>{t.volume=0})})}),window.__fc2CountersLoaded||(window.__fc2CountersLoaded=!0,document.addEventListener("DOMContentLoaded",function(){let t=document.querySelector(".real-counters");if(!t)return;function e(e,n){let i=t.querySelector(e);if(!i||Array.from(i.getElementsByTagName("script")).some(t=>t.src===n))return;let o=document.createElement("script");o.type="text/javascript",o.src=n,i.appendChild(o)}let n="localhost"===location.hostname||"127.0.0.1"===location.hostname;n||e(".all-visits","//counter1.fc2.com/counter.php?id=89511230"),e(".visits","https://counter1.fc2.com/counter.php?id=40270682&main=1"),e(".viewers","https://counter1.fc2.com/views.php?id=40270682&main=1")}));
